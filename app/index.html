<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>VROCCOR-TM</title>
    <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
    <!-- <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'"
    />
    <meta
      http-equiv="X-Content-Security-Policy"
      content="default-src 'self'; script-src 'self'"
    /> -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.4/font/bootstrap-icons.css"
    />
  </head>
  <body class="bg-dark text-white">
    <main class="p-4">
      <h1 class="text-center">VROVCOR APP</h1>
      <div class="row flex-lg-row-reverse align-items-center g-5 py-5">
        <div class="col-10 col-sm-8 col-lg-6">
          <!-- <img
            src="bootstrap-themes.png"
            class="d-block mx-lg-auto img-fluid"
            alt="Bootstrap Themes"
            width="700"
            height="500"
            loading="lazy"
          /> -->
          <canvas id="canvas">
            Lo sentimos, su navegador no es compatible &lt;canvas&gt;.
          </canvas>
        </div>
        <div class="col-lg-6">
          <!-- <h1 class="display-5 fw-bold text-body-emphasis lh-1 mb-3">
            Responsive left-aligned hero with image
          </h1>
          <p class="lead">
            Quickly design and customize responsive mobile-first sites with
            Bootstrap, the world's most popular front-end open source toolkit,
            featuring Sass variables and mixins, responsive grid system,
            extensive prebuilt components, and powerful JavaScript plugins.
          </p>
          <div class="d-grid gap-2 d-md-flex justify-content-md-start">
            <button type="button" class="btn btn-primary btn-lg px-4 me-md-2">
              Primary
            </button>
            <button type="button" class="btn btn-outline-secondary btn-lg px-4">
              Default
            </button>
          </div> -->
          <button type="button" class="btn btn-success" id="llamar">
            Iniciar conexión
          </button>
    
          <button type="button" class="btn btn-danger ms-5" id="colgar" disabled>
            Terminar conexión
          </button>
          <div class="container">
            <div class="row m-5">
              <div class="col-4">
                <button type="button" class="btn btn-light btn-lg" id="1">
                  <img src="./public/images/Giro a la izquierda.png" alt="Giro a la izquierda" height="90px">
                </button>
              </div>
              <div class="col-4">
                <button type="button" class="btn btn-light btn-lg" id="2">
                  <img src="./public/images/Avanze del veiculo.png" alt="Alto total" height="90px">
                </button>
              </div>
              <div class="col-4">
                <button type="button" class="btn btn-light btn-lg" id="3">
                  <img src="./public/images/Giro a la derecha.png" alt="Giro a la derecha" height="90px">
                </button>
              </div>
            </div>
            <div class="row m-5">
              <div class="col-4">
                <button type="button" class="btn btn-light btn-lg" id="4">
                  <img src="./public/images/Desplazamiento lento del eje vertical de la cámara para arriba.png" alt="Levantar la camara" height="90px">
                </button>
              </div>
              <div class="col-4">
                <button type="button" class="btn btn-light btn-lg" id="5">
                  <img src="./public/images/alto total.png" alt="Alto total" height="90px">
                </button>
              </div>
              <div class="col-4">
                <button type="button" class="btn btn-light btn-lg" id="6">
                  <img src="./public/images/Desplazamiento lento del eje vertical de la cámara para abajo.png" alt="Bajar camara" height="90px">
                </button>
              </div>
            </div>
            <div class="row m-5">
              <div class="col-4">
                <button type="button" class="btn btn-light btn-lg" id="7">
                  <img src="./public/images/Desplazamiento lento del eje horizontal de la cámara a la derecha.png" alt="Mover derecha camara" height="90px">
                </button>
              </div>
              <div class="col-4">
                <button type="button" class="btn btn-light btn-lg" id="8">
                  <img src="./public/images/Avance en reversa del vehículo.png" alt="Reversa" height="90px">
                </button>
              </div>
              <div class="col-4">
                <button type="button" class="btn btn-light btn-lg" id="9">
                  <img src="./public/images/Desplazamiento lento del eje horizontal de la cámara a la izquierda.png" alt="Mover izquierda camara" height="90px">
                </button>
              </div>
            </div>
            <!-- <div class="row m-5">
              <div class="col-4">
                <button type="button" class="btn btn-light btn-lg" id="10">
                  *
                </button>
              </div>
              <div class="col-4">
                <button type="button" class="btn btn-light btn-lg" id="0">
                  0
                </button>
              </div>
              <div class="col-4">
                <button type="button" class="btn btn-light btn-lg" id="12">
                  #
                </button>
              </div>
            </div> -->
          </div>
        </div>
      </div>
    </main>

    <script>
      const url = "wss://talent-hackathon-production.up.railway.app";
      var portStr = "";
      console.log(url + portStr + "/jpgstream_client");
      var ws = new WebSocket(url + portStr + "/jpgstream_client");
      var canvas = document.getElementById("canvas");
      var ctx = canvas.getContext("2d");

      var img = new Image();
      img.onload = function () {
        canvas.style.width = this.width + "px";
        canvas.style.height = this.height + "px";
        ctx.drawImage(
          this,
          0,
          0,
          this.width,
          this.height, // source rectangle
          0,
          0,
          canvas.width,
          canvas.height
        ); // destination rectangle
      };

      ws.onmessage = function (message) {
        if (message.data !== "terminated") {
          var url = URL.createObjectURL(message.data);
          img.src = url;
        } else {
          alert("La camara se ha desconectado");
          location.reload();
        }
      };

      // hangUpPhoneButton.addEventListener("click", () => {
      //   // end the current call
      //   call.hangUp({
      //     forEveryone: true,
      //   });

      //   // toggle button states
      //   hangUpPhoneButton.disabled = true;
      //   callPhoneButton.disabled = false;
      // });
    </script>
    <script src="./dist/renderer.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.7/dist/umd/popper.min.js"
      integrity="sha384-zYPOMqeu1DAVkHiLqWBUTcbYfZ8osu1Nd6Z89ify25QV9guujx43ITvfi12/QExE"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.min.js"
      integrity="sha384-Y4oOpwW3duJdCWv5ly8SCFYWqFDsfob/3GkgExXKV4idmbt98QcxXYs9UoXAB7BZ"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
